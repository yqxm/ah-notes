# 向量

向量是线性数组的一种抽象与泛化，它也是由具有线性次序的一组元素构成的集合$V = {v_0,v_1,...,v_{n-1}}$，其中的元素分别由秩(rank)相互区分。（秩：逻辑次序）

各元素的秩互异，且均为$[0,n)$内的整数。向量特有的元素访问方式，“循秩访问”(call-by-rank)。

## 动态空间管理

### 静态空间管理

向量内部数组所占的物理空间若在向量的生命周期内不允许调整，则称为静态空间管理策略。

缺陷：

- 容量固定，可能会导致上溢。
- 无法确定一个准确的预留量。

装填因子：向量实际规模与其内部数组容量的比值，用以衡量空间利用率。

### 可扩充向量

> 问题：如何实现扩容？新的容量取作多少？
另外申请一个容量更大的数组，并将原数组中的成员吉他搬迁至新的空间，释放原数组所占的空间。

### 分摊分析

#### 时间代价

每次扩容元素的搬迁都需要花费额外的时间。但随着数组容量的扩大，需要执行扩容操作的概率也迅速降低。平均意义上来说，扩容的时间成本并不高。

#### 分摊复杂度

分摊运行时间：将某个操作消耗的时间，分摊至所有的操作。

在扩充向量中，可以考察它连续n次（查询、插入或删除）操作，将所有操作钟用于内部数组扩容的时间累计起来除以n。只要n足够大，这一平均时间就是扩容处理的分摊时间成本。

假设数组的初始容量为N，初始规模也为N，需要连续进行n次`insert()`操作，且n>>N。

- `size(n)`：连续插入n个元素后向量的规模
- `capacity(n)`：连续插入n个元素后数组的容量
- `T(n)`：连续插入n个元素花费的扩容时间

有：

- `size(n) = N + n`
- 因为只有在的确即将发生溢出时容量才加倍，所以装填因子始终不低于50%
- `size(n) <= capacity(n) < 2*size(n)`

因为N为常数，故有：

$$capacity(n) = \Theta(size(n)) = \Theta(n)$$

容量以2为比例按指数速度增长，在容量达到`capacity(n)`之前，共做过$\Theta(log_2n)$次扩容，每次扩容所需时间线性正比于当时的容量，且同样以2为比例按指数速度增长。得到消耗于扩容的时间累计为：

$$T(n) = 2N + 4N + 8N + ... + capacity(n) < 2\bullet capacity(n) = \Theta(n)$$

将其分摊到连续n次操作，则分摊运行时间为$O(1)$

### 缩容

以25%为界，如果空间利用率小于它，则缩容。实际应用中为避免频繁交替扩容和缩容，可以选择更低的阈值。

与扩容类似，尽管单次缩容操作需要线性量级的时间，但其分摊复杂度亦为$O(1)$

## 常规向量
