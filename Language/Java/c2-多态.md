# 多态和接口

## 多态

用父类声明子类对象，使用时调用父类的接口，执行的是子类的代码。

将方法名和方法体连接称为绑定。绑定如果发生在程序执行之前，使用多态，编译器无法将正确的方法体绑定到方法名上。所以 Java 使用动态绑定，根据对象的类型决定将正确的方法体绑定到方法名。

注意不要“重写”父类的 private 方法。这会创建新方法，而没有形成多态。

字段和 static 方法不能形成多态。

被重写的方法的返回值可以是父类方法返回值的子类。

### 构造方法的顺序

先调用基类的构造方法，然后是子类的构造方法。（只谈构造方法）

别在构造方法里使用被重写的方法。因为调用构造方法时，对象的构建只完成了一部分，此时动态绑定的行为不能确定。

### 设计

使用继承来表示行为的不同，字段表示状态的不同。

is-a is-like-a 的关系来使用继承

have-a 的关系来使用字段

## 抽象类

抽象类可以包含字段，抽象方法，实现方法。抽象类不能`new`对象。
继承抽象类的非抽象类必须实现抽象方法。

## 接口

Java8 之前接口只有方法签名。Java8 之后，接口里可以有 defalt 方法和 static 方法。
接口中也可以定义字段，默认为 static&final 的。

接口用来形容一个类。

### default 方法

它最大的好处就是声明了一个方法而没有打坏现有代码的结构，子类可以很方便的进行重写。
多个接口的 default 方法冲突了的话，利用重写来解决这个问题。`super`关键字选择使用那个接口的方法。

### static 方法

static 方法带来了统一操作的工具。可以是操作接口本身的，也可以是操作外部的。

### 抽象类和接口的比较

| 特性               | 接口                                                             | 抽象类                   |
| ------------------ | ---------------------------------------------------------------- | ------------------------ |
| 组合               | 可以在一个类里继承多个接口                                       | 一个类只能继承一个抽象类 |
| 状态               | 不能包含字段（除了`static`字段）                                 | 可以包含字段             |
| 默认方法和抽象方法 | `default`方法不需要被重写，`default`方法只可以引用其他接口的方法 | 子类必须实现抽象方法     |
| 构造器             | 不能包含构造器                                                   | 可以有一个构造器         |
| 可见性             | 隐形`public`                                                     | 可以有`protected`        |

那么该使用哪个呢？一般来说“越抽象越好”，即使用接口。当需要使用抽象类的时候你自然就会知道。另外，除非必要，两个都不要用，KISS。

### 完全解耦

使用接口进行解耦，比如`Applicator.apply(Processor p)`中的`Processor`是一个类。此时如果有一个`Filter`和`Processor`的行为一样，但不能将它传给`apply()`的参数中。可以将`Processor`改为接口，利用适配器模式将`Filter`适配成`Processor`。

### 组合多个接口

一个类继承多个接口，那么它就可以向上转型成多个基本类型。

### 接口继承接口

一个接口可以继承多个接口。

避免这些接口的方法名相同。

### 内部接口

接口可以定义在类或者其他接口里面。可以设置内部接口的可见性。

### 建议

保持**KISS**原则。使用接口并不一定就是好的，使用太多的抽象会带来复杂性。
