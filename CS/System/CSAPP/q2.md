# 程序的机器级表示(x86-64)

## 程序编码

> 机器级编程中计算机系统给的两种重要抽象？

指令集架构和虚拟地址空间

> 程序计数器PC？

指示下一条指令的位置

> 整数寄存器？

16个整数寄存器，存储整数或者地址。

> 条件码寄存器?

保存指令运算的状态。

> 程序内存中包含哪些信息？

管理内存的运行时栈，操作系统所需要的信息，程序的可执行机器代码，用户分配的内存快

> 汇编代码和可执行程序的反汇编需要注意些什么？

反汇编代码完全是根据可执行程序生成的，它可能和真正的汇编代码有些不同

## 数据格式

> Intel的数据格式？

Intel定义一个字有16位，用“word”表示，汇编后缀为w。双字32位，汇编后缀为l。四字64位，汇编后缀为q。单精度浮点数占32位，汇编后缀为l，双精度浮点数占64位，汇编后缀为q。

## 访问信息

> 通用目的寄存器有多少个？

16个。存储整数或者地址。$rax可以存储返回值，$rsp指明栈指针的位置

> 操作数是什么，如何使用？

操作数指示一个操作中要使用的源数据。有三种指示数据的方式：

- 立即数： 使用一个确定的数值， 格式为$\$Imm$
- 寄存器： 使用寄存器中的值，格式为$r_a$
- 内存引用： 根据计算出来的内存地址，读取那个地址的值。

> 操作数对应的寻址方式是怎样的？

内存引用的寻址方式有很多中，但最基础的计算公式是$Imm(r_b, r_i, s)$，表示$Imm$加$r_b$加$r_i$乘以$s$的值，这个值就是要找的数的地址。

> 数据传送指令是怎样的？举一些数据传送指令的例子？

使用`mov`指令进行数据传送，他有两个操作数，第一个为源，第二个为目的。在x86-64中，任何为寄存器生成32位值的指令会把寄存器的高位设置为0

```armasm
movq $123, %rax 
```

> movabsq指令

这个指令是为了传送绝对的四字立即数。并且只能以寄存器为目的。

> 带扩展的数据传送指令是怎样的？

...

> 压栈和出栈操作指令？

...

## 算数逻辑操作

> 加载有效地址指令？它是怎样进行算数逻辑操作的？

...

> 解释一元和二元操作

...

> 解释移位操作

...

> 有哪些特殊的算术操作？

...

## 控制

> 解释一下条件码？

...

> 怎样访问条件码？

...

> 跳转指令的目标是如何编码的？

...

> 如何使用条件控制来实现条件分支？

...

> 如何使用条件传送来实现条件分支?

...

> 汇编如何实现各种循环？

...

> 汇编如何实现switch？

...

## 过程

> 什么是过程？

...

> 支持机器级过程的机制

...

### 运行时栈

> C语言过程调用的内存管理原则？

...

> 简单描述内存管理的过程？

...

> 什么时候需要在栈上分配空间？

...

> 什么是栈帧？

...

> 栈帧和函数

...

### 转移控制

> 什么是转移控制？

...

> 调用过程的指令

...

### 数据传送

> 什么是数据传送？

...

> 数据传送是如何实现的？

...

> 数据传送中参数和寄存器的关系？

...

## 栈上的局部存储

> 局部数据需要存放在内存中的情况？

...

### 寄存器中的局部存储空间

> 如何保证寄存器中的值不被另一过程覆盖？

...

> x86-64寄存器使用惯例

...

### 递归过程

> 递归过程下的栈和寄存器是怎样的？

...

## 数组的分配和访问

> 内存引用和数组访问

...

> & 和 * 的作用

...

> 嵌套数组的内存使用

...

> 编译器如何访问多维数组元素？

...

> GCC对定长数组的一些优化

...

> 对变长数组的支持

...

> 编译器的变长数组的优化

...

## 异质的数据结构

> 两种创建数据类型的机制？

...

> 什么是结构？数据在内存中是怎样安排的？

...

> 如何产生指向结构内部对象的指针？

...

> 什么是联合？它是怎样安排数据的？

...

> 联合的缺点和应用

...

> 什么是数据对齐？

...

## 控制与数据的结合

> 理解指针

...

> 什么情况下会出现内存越界？会导致什么错误？

...

> 缓冲区溢出导致的攻击

...

> 对抗缓冲区溢出攻击的方式

...

> 什么情况下会需要变长栈帧？

...

> 如何实现变长栈帧？

...

## 浮点代码

> YMM寄存器

...

> 如何引用YMM寄存器？

...

> 如何进行浮点传送？

...

> 如何进行浮点转换？

...

> 过程中的浮点代码是怎样的？

...

> 汇编中的浮点运算

...

> 汇编中定义和使用浮点常数

...

> 浮点代码的位级操作

...

> 浮点代码的比较操作

...
